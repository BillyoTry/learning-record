## 完善内核

### 系统调用

#### 实现getpid

系统调用就是让用户进程调用操作系统的功能，我们需要实现两部分，一部分属于用户空间，提供接口函数，另一部分作为内核具体实现。Linux中直接的系统调用就是宏**_syscall**,现在已经被库函数syscall替代，为了内核实现更简单，我们参考**_syscall**来实现系统调用，其用法大致思路如下：

1. 调用中断门实现系统调用，效仿Linux用0x80作为系统调用入口
2. 在IDT中安装0x80号中断对应的描述符，在该描述符中注册系统调用对应的中断处理例程
3. 建立系统调用子功能表，利用eax寄存器中的子功能号在该表中索引相应的处理函数
4. 用宏实现用户空间系统调用接口_syscall，最大只支持3个参数，eax为功能号，ebx保存第一个参数，ecx保存第二个参数，edx保存第三个参数

我们就按照这个步骤一步步完成代码，首先实现获取任务自己的PID的getpid

增加0x80号中断描述符 